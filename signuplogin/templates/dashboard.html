
<!DOCTYPE html>
<html>
<head>
    <title>Dashboard</title>

    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;600;700&display=swap" rel="stylesheet">

    <style>
        body{
            font-family: 'Poppins', sans-serif;
            margin:0;
            background:#f4f4f4;
        }

        /* ================= HEADER ================= */
        .header{
            background:#ffffff;
            padding:15px 30px;
            display:flex;
            align-items:center;
            gap:20px;
            box-shadow:0 2px 10px rgba(0,0,0,0.05);
        }

        .logo{
            color:#2874f0;
            font-weight:700;
            font-size:18px;
        }

        .search-box{
            flex:1;
            display:flex;
            justify-content:center;
        }

        .search-box input{
            width:100%;
            max-width:550px;
            padding:10px 16px;
            border-radius:22px;
            border:1px solid #ddd;
            font-size:14px;
            outline:none;
        }

        .header-right{
            display:flex;
            align-items:center;
            gap:16px;
        }

        .btn-link{
            padding:8px 14px;
            border-radius:10px;
            font-size:14px;
            text-decoration:none;
            font-weight:600;
            display:inline-flex;
            align-items:center;
            gap:6px;
            background:#6a5acd;
            color:white;
            cursor:pointer;
        }

        /* ================= USER DROPDOWN ================= */
        .user-dropdown{
            position:relative;
        }

        .dropdown-menu{
            position:absolute;
            right:0;
            top:48px;
            background:white;
            min-width:220px;
            border-radius:14px;
            box-shadow:0 12px 28px rgba(0,0,0,0.18);
            display:none;
            z-index:1000;
            overflow:hidden;
        }

        .dropdown-menu a{
            display:block;
            padding:12px 16px;
            color:#333;
            text-decoration:none;
            font-size:14px;
        }

        .dropdown-menu a:hover{
            background:#f7f7f7;
        }

        .dropdown-menu hr{
            margin:6px 0;
            border:none;
            border-top:1px solid #eee;
        }

        /* ================= MAIN ================= */
        .container{
            padding:25px;
        }

        h2{
            margin-top:0;
        }

        /* ================= CATEGORIES ================= */
        .categories{
            display:grid;
            grid-template-columns:repeat(auto-fit, minmax(160px, 1fr));
            gap:20px;
            margin-top:20px;
        }

        .cat-card{
            background:linear-gradient(180deg, #ffffff, #fff6f2);
            border-radius:20px;
            padding:22px 14px;
            text-align:center;
            box-shadow:0 8px 18px rgba(0,0,0,0.12);
            transition:0.3s ease;
        }

        .cat-card:hover{
            transform:translateY(-10px) scale(1.03);
            box-shadow:0 18px 34px rgba(236, 81, 207, 0.35);
        }

        .cat-card img{
            width:110px;
            height:110px;
            object-fit:contain;
            margin-bottom:12px;
            filter:drop-shadow(0 8px 14px rgba(0,0,0,0.15));
            transition:0.3s;
        }

        .cat-card:hover img{
            transform:scale(1.08);
        }

        .cat-card p{
            margin:0;
            font-weight:600;
            font-size:15px;
            color:#222;
        }

        a{
            text-decoration:none;
            color:inherit;
        }

        /* ================= DASHBOARD SECTIONS ================= */
        .dashboard-sections{
            display:grid;
            grid-template-columns:1fr 1fr;
            gap:32px;
            margin:40px 25px;
        }

        .section-box{
            background:white;
            padding:24px;
            border-radius:20px;
            box-shadow:0 10px 24px rgba(0,0,0,0.12);
        }

        .section-box h3{
            margin-bottom:20px;
            font-size:18px;
            font-weight:700;
            border-bottom:1px solid #eee;
            padding-bottom:10px;
        }

        /* ================= PRODUCTS ================= */
        .mini-products{
            display:grid;
            grid-template-columns:repeat(2,1fr);
            gap:22px;
        }

        .product-link{
            display:block;
            text-decoration:none;
            color:inherit;
        }

        .mini-card{
            background:#fff1ec;
            border-radius:18px;
            padding:16px;
            text-align:center;
            box-shadow:0 6px 14px rgba(0,0,0,0.1);
            transition:0.3s;
        }

        .mini-card:hover{
            transform:translateY(-6px);
            box-shadow:0 14px 30px rgba(255,167,143,0.35);
        }

        .mini-card img{
            width:100%;
            height:150px;
            object-fit:contain;
            margin-bottom:10px;
            filter:drop-shadow(0 10px 18px rgba(0,0,0,0.15));
        }

        .mini-card p{
            font-size:14px;
            margin:6px 0;
            font-weight:600;
        }

        .mini-card span{
            color:#2e7d32;
            font-weight:700;
        }

        @media(max-width:900px){
            .dashboard-sections{
                grid-template-columns:1fr;
            }
        }
        .offer-badge{
    position:absolute;
    top:12px;
    left:12px;
    background:#ff5252;
    color:white;
    font-size:12px;
    padding:4px 8px;
    border-radius:8px;
    font-weight:700;
}

.old-price{
    text-decoration:line-through;
    color:#888;
    font-size:13px;
}

.new-price{
    color:#2e7d32;
    font-size:16px;
    font-weight:700;
}

    </style>
</head>

<body>

<!-- ================= HEADER ================= -->
<div class="header">
    <div class="logo">Welcome to Ecommerce</div>

    <form class="search-box" method="get" action="{% url 'search' %}">
        <input type="text" name="q" placeholder="Search for products, categories..." required>
    </form>

    <div class="header-right">
        <a href="/cart/view/" class="btn-link">üõí Cart ({{ cart_count }})</a>
        <a href="{% url 'wishlist' %}" class="btn-link">‚ù§Ô∏è Wishlist ({{ wishlist_count }})</a>
        <a href="{% url 'settings' %}" class="btn-link">‚öô Settings</a>

        {% if request.user.is_authenticated %}
        <div class="user-dropdown">
            <div class="btn-link" onclick="toggleMenu(event)">
                üë§ {{ request.user.username }}
            </div>

            <div class="dropdown-menu" id="userMenu">
                <a href="{% url 'profile_page' %}">My Profile</a>
                <a href="{% url 'my_orders' %}">Orders</a>
                <a href="{% url 'my_addresses' %}">Saved Addresses</a>
                <a href="{% url 'wishlist' %}">Wishlist</a>
                <hr>
                <a href="{% url 'settings' %}">‚öô Settings</a>
                <a href="{% url 'logout' %}">Logout</a>
            </div>
        </div>
        {% else %}
        <a href="{% url 'login' %}" class="btn-link">Login</a>
        {% endif %}
    </div>
</div>

<!-- ================= CATEGORIES ================= -->
<div class="container">
    <h2>Categories</h2>
    <div class="categories">
        {% for cat in categories %}
        <a href="{% url 'category_products' cat.id %}">
            <div class="cat-card">
                <img src="{{ cat.image.url }}" alt="{{ cat.name }}">
                <p>{{ cat.name }}</p>
            </div>
        </a>
        {% endfor %}
    </div>
</div>

<!-- ================= TRENDING + RECOMMENDED ================= -->
<div class="dashboard-sections">

    <!--  TRENDING -->
    <div class="section-box">
        <h3> Trending Right Now</h3>
        <div class="mini-products">
            {% for product in trending_products %}
            <a href="{% url 'product_detail' product.id %}" class="product-link">
                <div class="mini-card">
                    <img src="{{ product.image.url }}">
                    <p>{{ product.name }}</p>
                    <span>‚Çπ{{ product.price }}</span>
                </div>
            </a>
            {% empty %}
            <p>No trending products</p>
            {% endfor %}
        </div>
    </div>

    <!--  RECOMMENDED -->
    <div class="section-box">
        <h3> Recommended For You</h3>
        <div class="mini-products">
            {% for product in recommended_products %}
            <a href="{% url 'product_detail' product.id %}" class="product-link">
                <div class="mini-card">
                    <img src="{{ product.image.url }}">
                    <p>{{ product.name }}</p>
                    <span>‚Çπ{{ product.price }}</span>
                </div>
            </a>
            {% empty %}
            <p>No recommendations yet</p>
            {% endfor %}
        </div>
    </div>

</div>

{% comment %} <!-- ================= OFFERS ================= -->
<div class="dashboard-sections">

    <div class="section-box">
        <h3> üí∏ Hot Deals & Offers</h3>

        <div class="mini-products">
            {% for product in offer_products %}
            <a href="{% url 'product_detail' product.id %}" class="product-link">
                <div class="mini-card" style="position:relative;">

                    <!-- OFFER BADGE -->
                    <div style="
                        position:absolute;
                        top:12px;
                        left:12px;
                        background:#ff5252;
                        color:white;
                        font-size:12px;
                        padding:4px 8px;
                        border-radius:8px;
                        font-weight:700;
                    ">
                        30% OFF
                    </div>

                    <img src="{{ product.image.url }}">

                    <p>{{ product.name }}</p>

                    <!-- ORIGINAL PRICE -->
                    <span style="text-decoration:line-through; color:#888; font-size:13px;">
                        ‚Çπ{{ product.price }}
                    </span>
                    <br>

                    <!-- DISCOUNTED PRICE -->
                    <span style="color:#2e7d32; font-size:16px; font-weight:700;">
                        ‚Çπ{{ product.offer_price }}
                    </span>

                </div>
            </a>
            {% empty %}
            <p>No offers available</p>
            {% endfor %}
        </div>
    </div>

</div> {% endcomment %}

<!-- ================= HOT DEALS + RECENTLY VIEWED ================= -->
<div class="dashboard-sections">

    <!-- üî• HOT DEALS -->
    <div class="section-box">
        <h3> Hot Deals & Offers</h3>

        <div class="mini-products">
            {% for product in offer_products %}
            <a href="{% url 'product_detail' product.id %}" class="product-link">
                <div class="mini-card" style="position:relative;">

                    <div class="offer-badge">30% OFF</div>

                    <img src="{{ product.image.url }}">
                    <p>{{ product.name }}</p>

                    <span class="old-price">‚Çπ{{ product.price }}</span><br>
                    <span class="new-price">‚Çπ{{ product.offer_price }}</span>
                </div>
            </a>
            {% empty %}
            <p>No offers available</p>
            {% endfor %}
        </div>
    </div>

    <!-- üïí RECENTLY VIEWED -->
    <div class="section-box">
        <h3>üïí Recently Viewed</h3>

        <div class="mini-products">
            {% for product in recently_viewed_products %}
            <a href="{% url 'product_detail' product.id %}" class="product-link">
                <div class="mini-card">
                    <img src="{{ product.image.url }}">
                    <p>{{ product.name }}</p>
                    <span>‚Çπ{{ product.price }}</span>
                </div>
            </a>
            {% empty %}
            <p>No recently viewed products</p>
            {% endfor %}
        </div>
    </div>

</div>




<script>
function toggleMenu(event){
    event.stopPropagation();
    const menu = document.getElementById("userMenu");
    menu.style.display = menu.style.display === "block" ? "none" : "block";
}

document.addEventListener("click", function(){
    const menu = document.getElementById("userMenu");
    if(menu){
        menu.style.display = "none";
    }
});
</script>

</body>
</html>
